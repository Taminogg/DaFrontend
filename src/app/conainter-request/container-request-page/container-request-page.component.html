<div class="overviewBox">
  <h1>{{
    (htmlContent === "containerRequestCS" ? 'container-page-header-cs' :
    (htmlContent === "containerRequestTL" ? 'container-page-header-tl' :
    (htmlContent === "productionPlanningCS" ? 'shippment-page-header-cs' : 'shippment-page-header-tl')))
    | transloco }}
  </h1>
  @if (htmlContent === 'containerRequestCS') {
  <button (click)="navigateToPage('/new-container-order-page')">
    <h2>{{'new' | transloco}}</h2>
  </button>
  }
</div>

<div class="searchBox">
  <label>Filter:&nbsp;</label>
  <select #currFilter (change)="setSelectedFilter(currFilter.value)">
    <option value="customername">{{'customer' | transloco}}</option>
    <option value="createdBy">{{'created-by' | transloco}}</option>
    <option value="status">{{'status' | transloco}}</option>
    <option value="lastUpdated">{{'last-updated' | transloco}}</option>
    @if (htmlContent === 'containerRequestCS') {
    <option value="approvedByCs">{{'approved-by-cs' | transloco}}</option>
    }
    @if (htmlContent === 'containerRequestCS' || htmlContent === 'containerRequestTL') {
    <option value="approvedByTl">{{'approved-by-tl' | transloco}}</option>
    }
    @if (htmlContent === 'productionPlanningCS') {
    <option value="approvedByPpCs">{{'approved-by-cs' | transloco}}</option>
    }
    @if (htmlContent === 'productionPlanningPP' || htmlContent === 'productionPlanningCS') {
    <option value="approvedByPp">{{'approved-by-pp' | transloco}}</option>
    }
    <option value="amount">{{'amount' | transloco}}</option>
    <option value="country">{{'country' | transloco}}</option>
    <option value="sped">{{'sped' | transloco}}</option>
  </select>
  <div>
    @if (selectedFilter() === 'customername' || selectedFilter() === 'createdBy' || selectedFilter() === 'country' ||
    selectedFilter() === 'sped') {
    <div>
      <input (change)="filterOrders()" [ngSignal]="filterValue" type="text"
        placeholder="{{'search-placeholder' | transloco}}">
    </div>
    }
    @if (selectedFilter() === 'amount' || selectedFilter() === 'status') {
    <div>
      <input (change)="filterOrders()" [ngSignal]="filterValue"
        type="{{selectedFilter() === 'amount' ? 'number' : 'text'}}">
    </div>
    }
    @if (selectedFilter() === 'approvedByCs' || selectedFilter() ===
    'approvedByTl' || selectedFilter() === 'approvedByPp' || selectedFilter() === 'approvedByPpCs') {
    <div>
      <input (change)="filterOrders()" [ngSignal]="filterValue" type="checkbox">
    </div>
    }
    @if (selectedFilter() === 'lastUpdated') {
    <div>
      <input (change)="filterOrders()" [ngSignal]="filterValue" type="date">
    </div>
    }
  </div>
  <button class="settings-button" (click)="settingsPage()">
    <mat-icon>settings</mat-icon>
  </button>
</div>

<div class="orderBox">
  <table>
    <tr>
      <th *ngFor="let header of dataService.tableHeaders" (click)="orderOrders(header.value)">{{header.label |
        transloco}}</th>
    </tr>
    @for (currOrder of dataService.allOrders(); track $index) {
    <tr>
      @for (prop of dataService.tableHeaders; track $index) {
      @if (prop.value !== 'approvedByCrCs' && prop.value !== 'approvedByCrTl' && prop.value !== 'approvedByPpCs' &&
      prop.value !==
      'approvedByPpPp') {
      @if(prop.value === 'chat'){
      <td (click)="navigateToPage('/chat-for-order/' + currOrder.id)"><mat-icon>chat</mat-icon></td>
      }@else if (prop.value === 'assignment') {
      <td (click)="openDialog(currOrder.checklistId)"><mat-icon>assignment</mat-icon></td>
      }@else if (prop.value === 'create') {
      <td (click)="navigateToEditPage(currOrder.id)"><mat-icon>create</mat-icon></td>
      }@else {
      <td>
        @if (prop.value === 'articleNumbers') {
        <label>{{getArticlesForOrder(currOrder.id)}}</label>
        }@else if(prop.value === 'factory') {
        <label>{{getFactoriesForOrder(currOrder.id)}}</label>
        }@else if(prop.value === 'plant'){
        <label>{{getPlantsForOrder(currOrder.id)}}</label>
        }@else {
        @if (currOrder[prop.value].toString().length > 30) {
        {{currOrder[prop.value].toString().substring(0, 30)}}...
        }@else {
        {{currOrder[prop.value]}}
        }
        }
      </td>
      }
      }@else {
      @if (currOrder[prop.value]) {
      <td>{{'yes' | transloco}}</td>
      }@else {
      <td>{{'no' | transloco}}</td>
      }
      }
      }
    </tr>
    }
  </table>
</div>